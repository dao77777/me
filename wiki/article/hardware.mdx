# Hardware

**厂商**
- [微雪](https://www.waveshare.net/)
- [乐鑫](https://www.espressif.com/zh-hans)

**社区**
- [硬创社](https://x.jlc.com)
- [拆解](https://www.52audio.com/archives/category/teardowns)

**查询**
- [芯查查](www.xcc.com)

**硬件采购**
- 华秋商城
- 立创商城
- 淘宝

**工具**
- 电烙铁, 热风枪, 加热台, 回流焊炉
- 焊锡, 针筒锡膏, 松香, 助焊剂
- 镊子
- 钢网
- 洗板水
- 吸锡带, 吸锡器
- 斜口钳
- 立创EDA
    - 原理图
        - 元件
            - 搜索:
            - 放置
            - 旋转: Space
            - 属性
                - 制造厂商
                    - 电气属性
                    - 规格
                    - 编号
                - 名称
                - 名称是否隐藏
                - 位号
                    - 电阻: R
                    - 电容: C
                    - 二极管: D
                    - 三极管: Q
                    - IC: U
                    - 灯: LED
                    - 开关: SW
                    - 排针: H
                    - 插件: J
                    - 电源: BAT
                    - 地: GND
        - 连线: Alt + W, left click set turn point, right click cancel state
        - 位号
            - 批量修改: 框选 -> 设置位号为`x?` -> 设计 -> 分配位号 -> 范围 -> 当前选中元件
        - 非连接标识符
        - 网络
            - 网络标号
            - 扇出网络标签
            - 短接网络达到多标号目的
        - 框线
        - DRC检查
    - PCB
        - 从原理图导入变更
        - 2D & 3D 视图
        - 大纲
            - 网络
            - 飞线
        - 选择
            - 取消选择: ctrl + lclick
            - 点选: lclick
            - 多选: ctrl + lclick
            - 框选
            - 交叉选择: 在原理图和PCB之间进行交叉选择
        - 布局
            - 长度测量
            - 放置
            - 旋转
            - 选中布局
                - 居中
                - 等距分布: 中心间距, 边沿间距, 同边沿间距
                - 阵列分布
        - 间距限制
            1. 工艺能力
            2. 电气要求
        - 单位切换: Q, 嘉立创超过100mm的单不再免费
            - mil
            - mm
        - 视图层级
            - 隐藏
            - 锁定
            - 颜色
        - 多层板
            - 切换顶层: alt + t
            - 切换底层: alt + b
        - 板框
            - 长宽
            - 圆角
        - 布线
            - Alt + W
            - 打孔: Alt + V
        - 坐标文件, Gerber文件, BOM文件

**PCB制作工艺流程**
1. 覆铜板
2. 打孔: 过孔(通孔, 盲孔, 埋孔) -> 孔壁活化 + 孔壁沉铜
4. 电路蚀刻： 覆薄膜 + 光蚀刻勾勒电路 -> 电路电镀锡 + 洗去蓝色薄膜 -> 洗去暴露的铜箔 + 洗去锡
7. 电路测试: AOI扫描, 四线低阻测试(阻抗通断测试)
8. 绝缘层: 刷绝缘涂层 -> 暴露焊盘焊点 -> 丝印 -> 喷锡(有铅, 无铅) 或 沉金
9. 若为拼板, 则还有锣板 和 v-cut 工艺

**贴片**
- 电烙铁 + 锡丝 + 松香
- 锡膏 + 钢网 + 加热台 或 回流焊炉 或 热风枪
- 贴片机
    - openpnp
    - 龙门架结构, 铝型材, 直线导轨, 皮带
    - feeder(飞达)
- 洗板: 洗板水
- 拆板: 电烙铁 或 加热台 + 吸锡带 或 吸锡器

**多层板**
- 层数
    - 2层板: 双面覆铜板
    - 4层板: 2层双面覆铜板夹1层绝缘基材
    - 6层板: 3层双面覆铜板夹2层绝缘基材
- 过孔
    - 通孔: 贯穿多层板的孔
    - 盲孔: 从顶层或底层出发不贯穿多层板的孔
    - 埋孔: 埋在多层板内部的孔

**元器件**
- 定义: 功能, 电气特性, 外观与封装, 原理图符号, PCB封装, 厂商, 编号
- 类型
    - 电阻
    - 电容
    - 二极管
    - 三极管
    - IC
- 元器件封装
    - 插件
        - DIP: 两边插入式引脚
    - 贴片
        - SOIC: 两边扁平
        - QFP: 四边扁平
        - BGA: 球栅阵列
- 元器件规格
    - 008004
    - 01005
    - 0201
    - 0402
    - 0603
    - 0805


经验值
- PCB载流
    - 电流和线宽(外层线宽, 内层线宽)的关系

电源线, 信号线的走线避免出现直角

高亮选定的网络: Shift + H

布局 -> 布线 -> 泪滴 + 铺铜 -> 丝印

框选轮廓对象 -> 

泪滴: 防止腐蚀液堆积
- 焊盘与走线过渡
- 粗细走线过渡
- T型连接过渡

丝印
- 图片
- 文本
- 形状线条或填充

避免直角走线: 防止信号干扰

焊盘与普通区域连接方式
- 桐桥连接: 减少焊接时热量过快降低
- 直连: 电流负载较大用这种方式

PCB板材
- FRC软板
- FR-4玻璃纤维
- 铝基板
- 铜基板
- 罗杰斯高频板
- 铁氟龙高频板

CR2032, switch, led, 100

DRC检查

**外设**
- 保险丝
- IO
    - LED
        - 封装: 插件式
    - 开关
        - 无锁开关
        - 自锁开关
- 接口
    - 排针
        - 间距
        - 粗细
        - 个数
    - 跳线帽
    - USB Micro-B
        - 1: VCC
        - 2: D-
        - 3: D+
        - 4: ID
        - 5: GND
    - USB Type-C: 标准24pin, 可以砍掉高速传输引脚变成16pin, 砍掉音视频传输引脚变14pin, 仅保留供电变6pin
        - GND & VBUS: 供电
            - VBUS: 外围电路一般接自恢复保险丝 + 并联两个滤波电容(10uf + 100nf)
        - CC: 协商充电协议, 设备身份
            - 供电协议
                - 传统USB供电协议: USB1.0 & USB2.0 最高2.5W, USB3.0 最高4.5W
                - PD协议: PD3.0 最高100W, PD3.1 最高240W
                - QC协议
            - 外围电路
                - 传统协议: 5.1k电阻 + 接地, 默认5V电压
                - 快充协议: 接快充协议协商芯片
        - TX+ & TX- & RX+ & RX-: 高速数据传输
        - D+ & D-: 普通数据传输
        - SBU: 传输音视频信号
- 电路
    - 滤波电路: 并联两个滤波电容
        - 高频干扰: 大电容, 10uf
        - 低频干扰: 小电容, 100nf
    - 半波整流电路: 二极管整流 + 滤波电容
- 晶振
    - 无源晶振(石英): 外接时钟电路, 皮尔斯震荡电路
    - 有源晶振: 不用外接时钟电路, 只需供电加输出XTAL1就行
    - 11.0592MHZ, 20pf
    - XTAL1, XTAL2
- IC
    - AMS1117-3.3V: 低压差线性稳压器
    - 74系列芯片: 74HCxxx
        - 38译码器(74HC138)
            - VCC & GND
            - A0-A2
            - CS1-CS3
            - Y0-Y7
        - 245信号放大器(74HC245)
            - VCC & GND
            - DIR
            - OE
            - A1-A8
            - B1-B8

circuitjs

核心板
- 电源模块
- 程序烧录模块
    - USB Type-C
        - VCC & GND: 保险丝 -> 并10uf & 100nf电容滤波, 主电路
        - D+ & D-
        - CC: 5.1k电阻 -> 接地
        - SBU: 悬置
- MCU最小系统

**开发板**
- ESP32-P4-Nano, 微雪做的小型P4的开发板
- ESP32-P4-Function-EV-Board, 乐鑫官网的开发板
- ESP32-DEVKITV1, 握有的板子, 模组是ESP-WROOM-32

MIPI-CSI, MIPI-DSI

电池, 充电管理, 稳压

usb转串口, 复位 & 下载按键

主控芯片

屏幕, led

温湿度传感器

原理图 -> PCB设计 -> PCB -> PCBA

推挽输出, 开漏输出

下/上拉电阻: 芯片引脚不串联任何用电器, 直接通过一个电阻接地/VCC, 电阻越小, 下/上拉力度越大, 一般10k左右
- 强下/上拉电阻: 1k~10k
- 弱下/上拉电阻: 10k~100k, 或以上

延时电路: 电容延时

滤波电路

复位电路: 延时电路 + 下拉电阻

自动冷启动电路

51单片机启动流程: 上电 -> 检查是否有下载代码流 -> 如有则下载代码 -> 启动程序

51单片机复位流程: 复位 -> 重新执行程序

供电指示灯

mos管
- 振铃效应: 寄生电感导致, 外接阻尼越小越明显
- 米勒平台: 寄生电容导致, 外接阻尼越大越明显
- 选择的阻值一般在10~100

CH340N: 差分 `<=>` TTL
- VCC & GND
- UD+ & UD-
- RXD & TXD
- RTS#
- V3

- 单片机STC89C52RC
- P0上拉电阻
- 单片机电源开关
- 复位按键
- CH340N差分转TTL
- 自动冷启动电路
- TypeC接口
- MCU供电指示灯
- 通信指示灯
- 5V转3.3V
- 排针输出
- 外部晶振

载流计算: 导线(与线宽相关), 过孔(与内径和铜壁厚相关)

差分信号抗干扰

灌电流, 拉电流

防电流倒灌电路

肖特基二极管

N沟道MOS管

P沟道MOS管

doxygen documentation generator

- I2C
    - SCL: 时钟总线
    - SDA: 数据总线
- TTL
- SPI
    - SCK: 时钟总线
    - MOSI: 主机输出从机输入
    - MISO: 主机输入从机输出
    - NSS
|SPI模式|CPOL|CPHA|空闲状态下的时钟极性|用于采样和/或移位数据的时钟相位|
|:-:|:-:|:-:|:-:|:-:|
|0|0|0|逻辑低电平|数据在上升沿采样, 在下降沿移出|
|1|0|1|逻辑低电平|数据在下降沿采样, 在上升沿移出|
|2|1|1|逻辑低电平|数据在下降沿采样, 在上升沿移出|
|3|1|0|逻辑低电平|数据在上升沿采样, 在下降沿移出|


## 桌面小屏幕

资料获取: 公众号: 小智学长嵌入式 -> 免费资料 -> [桌面小屏幕资料](https://x509p6c8to.feishu.cn/docx/NQCTdjUFJoYoZ1xYHS9cIlbwnxh)
**工程**
- 硬件
    - PCBA工程文件
    - 生产文件: 用于嘉立创一键下单
    - BOM文件: 元件清单
    - 坐标文件
    - wifi模组: 安信可ESP32-S 或者 乐鑫ESP32-WROOM-32E
    - 墨水屏: GDEH0154D67
    - 电池: 锂电池, 562828, 3.7v/5v, 700mAh
    - 外壳及组装零件
        - 前壳
        - 压板
        - 后壳
        - 支架
        - 不锈钢滚花销轴2x6
        - 镀镍沉头自攻螺丝M2x10
        - 磁铁直径2.5mm, 厚度2.5mm, 胶水粘贴
        - 磁铁直径15mm, 厚度1mm, 胶水粘贴
- 软件
    - 源码
    - 墨水屏GDEH0154D67固件

**烧录**
- `partition-tabl.bin`: 0x8000
- `bootloader.bin`: 0x1000
- `DesktopScreen`: 0x10000
- `DesktopScreenFont`: 0x15D000

spiffs

partitions.csv
```csv
Name,     Type, SubType,  Offset,   Size,   Flags
nvs,      data, nvs,      0x9000,   0x6000,
phyinit,  data, phy,      0xf000,   0x1000,
factory,  app,  factory,  0x10000,  1M,
storage,  data, spiffs,   ,         0xF0000,
```

## TODO

CH340

USB
- USB-TypeB
- USB-TypeC

串口
- UART
- RS232
- RS485

波特率, 时钟信号, 编码
- 晶体管
    - mos管
        - 引脚
            - 栅极(g, gate)
            - 源极(s, source)
            - 漏极(d, drain)
        - 参数
            - 封装: sop-8, sot-23, sot-89, to-220, to-252
            - Vgsth: 开启mos管的临界电压
            - Rdson: 开启mos管后的阻值
            - Cgs: 寄生电容
        - 分类
            - pmos: 常用作上管接芯片,比nmos贵, Rdson一般比nmos大
            - nmos: 常用作下管接用电器
    - 继电器
    - 三极管: s8050
        - 分类
            - 型
                - npn型: 8050, 9013, 9014, 9018
                - pnp型: 8550, 9012
            - 类
                - 三极管
                - 光敏三极管
        - 引脚
            - B: 基极
            - E: 发射极
            - C: 集电极
        - 经典小电流端阻值 4.7k
        - 三种状态: 饱和状态, 放大状态, 截至状态
        - 三极管开关电路
        - 三极管放大电路
        - 光敏电阻电路, 热敏电阻电路, 电位器电路
    - IGBT
    - 二极管: 1N4149, 1N4007(整流专用)
        - 分类
          - 二极管
          - 发光二极管
          - 光敏二极管
          - 稳压二极管(齐纳二极管)
          - 红外二极管
          - 激光二极管
          - 肖特基二极管
          - 双向触发二极管
          - 高压二极管
          - 大功率二极管
        - 参数
            - 压降: 硅管0.6-0.8V, 锗管0.2-0.3V
            - 阈值电压: 硅管0.5V, 锗管0.1V
        - 应用
            - 极性用电器保护
            - 电流防倒灌
            - 全桥整流
- 声
    - 蜂鸣器
    - 扬声器
    - 麦克风
- 光
    - 数码管
        - 引脚
            - a, b, c, d, e, f, g: 段码
            - p: 小数点
- 磁
    - 干簧管
- 能
    - 电源: VCC, VDD, VSS
        - 参数
            - 容量
            - 内阻
            - 输出电压
            - 最大输出电流
            - 封装
        - 分类
            - 纽扣电池: CR2032
    - 电容
        - 分类
            - 独石电容
            - 瓷片电容
            - 电解电容
            - 钽电容
- 电阻
    - 阻值: 限流 5-1k, 上拉/下拉 5k-10k
        - 5, 10, 51, 100, 200, 470, 510, 620, 750, 820
        - 1k, 2.2k, 4.7k, 5.1k, 7.5k, 8.2k
        - 10k, 12k, 15k, 20k, 47k, 56k, 68k, 75k, 82k
        - 100k, 200k, 430k, 510k
        - 1m
    - 分类
        - 电阻
        - 光敏电阻
        - 热敏电阻
        - 电位器
    - 参数
        - 阻值
        - 精度
        - 功率
        - 封装

稳压: 齐纳二极管, DCDC芯片, LDO芯片

稳压器
- 低压差线性稳压器(LDO): 容易发烫, AMS117
- 开关稳压器(DCDC): 比起LDO更高效, 发热更低, LM2596, MP1584, TPS5430
    - converter
    - controller

芯片
- NE555: 时基芯片
- CD4069: 反向器芯片
- CD4017: 十进制译码/计数芯片
- CD4011: 与非门芯片
- CD4026: 十进制数码管译码/计数芯片
- LM386: 音频放大器芯片

正负极表示
- 正极: Vs, Vcc, Vdd
- 负极: GND, Vss, Vee

无稳态, 单稳态, 双稳态, 三稳态

比较器电路(运放)

RS触发器(双稳态触发器)
- R: 触发低电平
- S: 触发高电平
- Q
- 非Q
- RESET

非门, 与门, 或门, 与非门, 或非门, 异或门, 同或门, 半加器, 加法器, 译码器, 存储器, 寄存器, 时钟频率发生器

TTL电平, CMOS电平

电流镜

存储芯片
- 93C46: EEPROM芯片, 128字节

CD系列芯片, 74系列芯片

起始, 操作, 地址, 数据, 结束

SPI
- 通讯模式: 一主多从, 全双工
- 引脚
    - SCK: 时钟信号线, 上升/下降沿采样, 高/低电平时钟空闲, 跳变时钟忙碌
    - MOSI: Master Out Slave Input
    - MISO: Master Input Slave Output
    - SS: 片选信号线, 低电平生效

I2C
- 通讯模式: 一主多从, 半双工, M -> S 推送, S -> 请求/响应
- 引脚
    - SCL: 时钟信号线, 高电平采样, 上升沿起始位, 下降沿结束位
    - SDA: 数据线
        - 格式: 下降沿起始位, 8数据位, 1应答位, 上升沿结束位
        - 功能
            - 应答位: 由于SDA默认接上拉电阻, 应答位低电平表示接收成功
            - 读写判断: 第一个字节末位0表示写, 末位1表示读, 写数据时, 第二个字节表示写入子地址
            - 多从设备通信: 第一个字节前7位表示器件地址, 以下为保留地址
            |从机地址|R/W位|描述|
            |0000 000|0|广播呼叫地址|
            |0000 000|1|起始字节|
            |0000 001|x|CBUS地址|
            |0000 010|x|保留给不同总线格式|
            |0000 011|x|保留将来使用|
            |0000 1xx|x|Hs模式主机码|
            |1111 1xx|x|保留将来使用|
            |1111 0xx|x|10位从机寻址|

上升沿采样, 下降沿采样, 高电平采样, 低电平采样

FET
- JFET: N-JFET & P-JFET
- MOSFET
    - 增强型(最广泛使用): NMOS & PMOS
    - 耗尽型: NMOS & PMOS

提高输出能力, 防漏电, 防电流倒灌, 滤波

数模芯片

逻辑门电路芯片, 放大器芯片, 计数/译码器芯片, 特殊功能芯片

全桥整流电路

整流, 滤波, 稳压, 变频, 放大

运放电路

自举升压

续流二极管

纹波

pwm, 交流电, 开关电路, 变频器, 电机驱动器

正弦波, 三角波, 锯齿波, 声波

漏电流

光耦
